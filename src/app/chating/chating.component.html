<app-header></app-header>

<div class="sidenav left">
  <div class="friend_list">
    <h3>Friends</h3>
  </div>
  <div class="parent_chat_panel">
  <div class="row" class="chat_panel" *ngFor="let data of frdDetails;let i = index">
    <div class="remove_people remove_people_{{data._id}}" (click)="openChat(data._id, data.name)">
      <div class="request_shows online_sec">
        <div class="online_title">
          <img [src]="data.profileImgURl" onerror="this.src='/assets/images/character.png';" style="border-radius: 50%;" />
        </div>
        <div class="user_name">{{data.name}}</div>
      </div>
    </div>
  </div>
  </div>
</div>

<div class="viewProfile show_View" style="justify-content: center;display: flex;height:100%" *ngIf="showView">
  <div class="container" style="position: relative;">
    <div class="vertical-center" style="position: inherit;top: 50%;transform: translateY(-50%);text-align: center;">
      <div class="display_people_data">
        Select people's names to start chatting with them.
      </div>
    </div>
  </div>
</div>

<div class="viewProfile" style="padding-top: 101px;" *ngIf="!showView">
  <div class="chat-messages" >
    <div class="chat-messages-show-container" #content>
        <ul class="chat-messages-show-list" id="message-list" >
          <li *ngFor="let chat of chat_messages" #messages  [ngStyle]="{'text-align':chat.senderID === current_user_id ? 'right' : 'left', 'justify-content': chat.senderID === current_user_id ? 'flex-end' : 'flex-start'}" style="display: flex;"> 
            <div [ngStyle]="{'background':chat.senderID === current_user_id ? '#ffffff' : '#0f1b31'}" class="chat_message_div">
              <span [ngStyle]="{'color':chat.senderID === current_user_id ? '#0f1b31' : '#ffffff'}">{{chat.message ? chat.message : message}}</span>
              <div [ngStyle]="{'color':chat.senderID === current_user_id ? '#949292' : '#909090'}" style="font-size: 12px;"> {{chat.createdAt | timeago}} </div>
            </div>
          </li>
        </ul>
        <div class="default_thumbnail" *ngIf="chat_messages.length == 0">
          <h1>Say Hi to your friend</h1>
        </div>
    </div>
    <div class="chat-messages-create-container">
        <i id="typing"></i>
        <input id="message" class="chat-messages-create-input" [(ngModel)]="message" type="text" (keyup.enter)="SendMessage()" placeholder="Type your message here...">
        <button class="chat-messages-create-button" [disabled]="!message" (click)="SendMessage()"> Send </button>
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal"> <img src="../../assets/images/chat.png" alt="" width="20px" height="20px"> </button>
    </div>
    </div>
</div>

<!-- The Modal -->
<div class="modal" id="myModal">
  <div class="modal-dialog">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title"> {{temp_name}} </h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>

      <!-- Modal body -->
      <div class="modal-body">
        <div id="app">
          <span id="myid"> </span>
          <video id="selfview"></video>
          <video id="remoteview"></video>
          <div id="list" style="display: flex;justify-content: space-around;">
            <button class="btn btn-primary" (click)="callUser(check_user)"> <img src="../../assets/images/telephone.png" alt="" width="40px" height="40px"></button>
            <button id="endCall" class="btn btn-danger" style="display: none;" (click)="endCurrentCall()"><img src="../../assets/images/reject.png" alt="" width="40px" height="40px"> </button>
          </div>
        </div>
      </div>

      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
      </div>

    </div>
  </div>
</div>
